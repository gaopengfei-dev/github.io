(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{553:function(t,e,a){},646:function(t,e,a){"use strict";var n=a(238),o=a(18),i=a(40),r=a(647),s=a(239);n("search",(function(t,e,a){return[function(e){var a=i(this),n=null==e?void 0:e[t];return void 0!==n?n.call(e,a):new RegExp(e)[t](String(a))},function(t){var n=a(e,this,t);if(n.done)return n.value;var i=o(this),l=String(t),p=i.lastIndex;r(p,0)||(i.lastIndex=0);var c=s(i,l);return r(i.lastIndex,p)||(i.lastIndex=p),null===c?-1:c.index}]}))},647:function(t,e){t.exports=Object.is||function(t,e){return t===e?0!==t||1/t==1/e:t!=t&&e!=e}},648:function(t,e,a){"use strict";a(553)},720:function(t,e,a){"use strict";a.r(e);a(15),a(57),a(646),a(68),a(69),a(42),a(89),a(43),a(111);var n={data:function(){return{map:null,viewMode:"3D",layerCtrl:!1,cityinfo:"",startPoint:"",driving:null,pullZoomTxt:"拉框缩放",endPoint:"",routeInfo:null,polyEditor:null,marker:null,pullZoom:null,addHeiMarCtrl:null,statelLayer:null,heatmap:null,heatmapCtrl:!1,hotMapCtx:"显示热力图",centerVal:[117.132461,39.222528]}},mounted:function(){this.getMap()},methods:{getMap:function(){this.map=new AMap.Map("container_map",{zoom:15,center:this.centerVal,mapStyle:"amap://styles/3db07b66500b67eb910674bf717d6a59",viewMode:this.viewMode,pitch:70,jogEnable:!0,rotateEnable:!0,animateEnable:!0,buildingAnimation:!0}),this.statelLayer=new AMap.TileLayer.Satellite({}),this.map.addControl(new AMap.ControlBar({showZoomBar:!0,showControlButton:!0,position:{bottom:"-180px",left:"-70px"}})),this.hanldeRelation(),this.map.on("click",(function(t){console.log(t.lnglat.lng,t.lnglat.lat)})),this.regionFn(),this.modelTrans(),this.pointAggre(),this.waterRipple(),this.flyLine()},showHotMap:function(){var t,e=this;if(this.heatmap)this.heatmapCtrl?(this.heatmap.show(),this.hotMapCtx="关闭热力图",this.heatmapCtrl=!1):(this.heatmap.hide(),this.heatmapCtrl=!0,this.hotMapCtx="显示热力图");else{var a=[{lng:117.133461,lat:39.232528,count:105},{lng:117.143142,lat:39.123827,count:150},{lng:117.133461,lat:39.232528,count:245},{lng:117.227351,lat:39.149062,count:120},{lng:117.225772,lat:39.123827,count:715}];this.hotMapCtx="关闭热力图",(t=document.createElement("canvas")).getContext&&t.getContext("2d")||alert("热力图仅对支持canvas的浏览器适用,您所使用的浏览器不能使用热力图功能,请换个浏览器试试~"),e.map.plugin(["AMap.Heatmap"],(function(){e.heatmap=new AMap.Heatmap(e.map,{radius:25,opacity:[0,.8]}),e.heatmap.setDataSet({data:a,max:100})}))}},rolutPlan:function(){var t=this;this.driving&&(this.driving.clear(),this.routeInfo=null),this.driving=new AMap.Driving({map:t.map,panel:"panel"});var e=[{keyword:t.startPoint},{keyword:t.endPoint}];this.driving.search(e,(function(e,a){"complete"===e?(t.routeInfo=a.routes[0].steps,log.success("绘制公交路线完成")):log.error("公交路线数据查询失败"+a)}))},trajectoryFn:function(){var t=this,e=this.routeInfo,a=[];e.forEach((function(t,e){t.path.forEach((function(t){a.push([t.lng,t.lat])}))})),this.marker&&(this.marker.hide(),this.marker=null),this.marker=new AMap.Marker({map:t.map,position:a[0],icon:"https://webapi.amap.com/images/car.png",offset:new AMap.Pixel(-26,-13),autoRotation:!0,angle:-90}),this.marker.on("moving",(function(e){t.map.setZoomAndCenter(15,e.target.getPosition())})),t.map.setFitView(),t.marker.moveAlong(a,1e3)},drawBuild:function(){var t=new AMap.Object3DLayer;this.map.add(t);var e=[[117.132273,39.222712],[117.132681,39.222622],[117.13259,39.222131],[117.132205,39.222241]].map((function(t){return new AMap.LngLat(t[0],t[1])})),a=new AMap.Object3D.Prism({path:e,height:800,color:"rgba(247, 216, 0, 1)"});a.transparent=!0,t.add(a)},autoBuild:function(t){var e=[];t.forEach((function(t){e.push([t.lng,t.lat])}));var a=new AMap.Buildings({zIndex:130,merge:!1,sort:!1,zooms:[5,18]}),n={hideWithoutStyle:!1,areas:[{rejectTexture:!0,color1:"9441D4B4",color2:"cc0E1612",path:e}]};a.setStyle(n);var o=[new AMap.TileLayer,a];this.map.setLayers(o),this.modelTrans()},drawRegion:function(){var t=this,e=new AMap.MouseTool(t.map),a=[];e.on("draw",(function(e){a.push(e.obj),console.log(e),t.autoBuild(a[0].w.path)})),e.polygon({strokeColor:"#e9ec07",strokeOpacity:.1,fillColor:"#1791fc",fillOpacity:.01,strokeStyle:"solid"})},modelTrans:function(){var t,e=this,a=new AMap.Object3DLayer;e.map.add(a);function n(t){return 1-Math.pow(t,.3)}!function(){(t=new AMap.Object3D.Mesh).transparent=!0,t.backOrFront="front";var o=t.geometry,i=200;i/=e.map.getResolution(e.centerVal,20);for(var r=0;r<200;r+=1){var s=1*r*Math.PI/180,l=1*(r+1)*Math.PI/180,p=Math.cos(s)*i,c=Math.sin(s)*i,h=Math.cos(l)*i,d=Math.sin(l)*i;o.vertices.push(0,0,0),o.vertices.push(p,c,0),o.vertices.push(h,d,0);var u=n(r/200),m=n((r+1)/200);o.vertexColors.push(0,1,.2,u),o.vertexColors.push(0,1,.2,u),o.vertexColors.push(0,1,.2,m)}t.position(e.centerVal),a.add(t)}(),function e(){t.rotateZ(-2),AMap.Util.requestAnimFrame(e)}()},setMeshLayer:function(){var t=new AMap.Object3DLayer;this.map.add(t);var e=this.map.lngLatToGeodeticCoord(this.map.getCenter()),a=[0,1,1,.9],n=[0,1,1,.4],o=[0,0,1,.9],i=function(e,i,r,s){var l=new AMap.Object3D.Mesh,p=l.geometry,c=2*i;console.log(i);for(var h=[],d=0;d<i;d+=1){var u=2*Math.PI*d/i,m=e.x+Math.cos(u)*s,v=e.y+Math.sin(u)*s;h.push([m,v]),p.vertices.push(m,v,0),p.vertices.push(m,v,-r),p.vertexColors.push.apply(p.vertexColors,o),p.vertexColors.push.apply(p.vertexColors,a);var f=2*d,g=f+1,M=(f+2)%c,w=(f+3)%c;p.faces.push(f,g,w),p.faces.push(f,w,M)}for(var y=0;y<i;y+=1)p.vertices.push.apply(p.vertices,p.vertices.slice(6*y+3,6*y+6)),p.vertexColors.push.apply(p.vertexColors,n);for(var x=AMap.GeometryUtil.triangulateShape(h),A=2*i,C=0;C<x.length;C+=3)p.faces.push(x[C]+A,x[C+2]+A,x[C+1]+A);l.transparent=!0,t.add(l)};i(e.add(new AMap.Pixel(-1500,0)),3,1800,500),i(e,5,1200,500),i(e.add(new AMap.Pixel(1500,0)),32,1600,500)},autoDrawRegion:function(){var t=this,e=new AMap.Polygon({path:[[117.132273,39.222712],[117.132681,39.222622],[117.13259,39.222131],[117.132205,39.222241]],strokeColor:"#FF33FF",strokeWeight:6,strokeOpacity:.2,fillOpacity:.4,fillColor:"#1791fca0",zIndex:50});this.map.add(e),this.map.setFitView([e]),this.polyEditor=new AMap.PolyEditor(t.map,e),this.polyEditor.on("addnode",(function(t){log.info("触发事件：addnode")})),this.polyEditor.on("adjust",(function(t){log.info("触发事件：adjust")})),this.polyEditor.on("removenode",(function(t){log.info("触发事件：removenode")})),this.polyEditor.on("end",(function(e){console.log(e),t.autoBuild(e.target.w.path),log.info("触发事件： end")}))},getCity:function(){var t=new AMap.CitySearch,e=this;t.getLocalCity((function(t,a){"complete"===t&&"OK"===a.info&&a&&a.city&&a.bounds&&(e.cityinfo=a.city,console.log(e.cityinfo))}))},hanldeRelation:function(){var t=this,e=new AMap.Marker({position:[117.132461,39.222528],map:t.map,clickable:!0}),a=e.getPosition();this.circle=new AMap.Circle({center:new AMap.LngLat(a.lng,a.lat),radius:100,strokeColor:"#76D5C2",strokeOpacity:0,strokeWeight:0,fillColor:"#3897FF",bubble:!0,fillOpacity:.13}),this.map.add(this.circle);var n=new AMap.Marker({position:[117.132403,39.223604],map:t.map,draggable:!0,clickable:!0});n.on("dragging",(function(){var a=n.getPosition(),o=e.getPosition(),i=[];i[0]=[],i[1]=[],i[0].push(a.lng,a.lat),i[1].push(o.lng,o.lat),new AMap.Polyline({path:i}),n.setLabel({content:t.circle.contains(a)?"内部,距离："+i[0].distance(i[1]).toFixed(2)+"米":"外部,距离："+i[0].distance(i[1]).toFixed(2)+"米",offset:new AMap.Pixel(20,0)})}))},addHeightMarker:function(){var t=this;if(!this.addHeiMarCtrl){var e=new AMap.Object3DLayer({zIndex:110,opacity:1});this.addHeiMarCtrl=e,t.map.add(e);var a=new AMap.Object3D.Line,n=a.geometry;new AMap.DistrictSearch({subdistrict:1,extensions:"base"}).search("天津",(function(o,i){var r=i.districtList[1].districtList,s=new AMap.Object3D.RoundPoints;s.transparent=!0;for(var l,p=s.geometry,c=0;c<r.length;c+=1){var h=(l=r[c].center,(l=t.map.lngLatToGeodeticCoord(l)).x=AMap.Util.format(l.x,3),l.y=AMap.Util.format(l.y,3),l),d=Math.max(10,Math.round(40*Math.random())),u=1e3*-d;n.vertices.push(h.x,h.y,0),n.vertexColors.push(0,1,1,1),n.vertices.push(h.x,h.y,u),n.vertexColors.push(0,1,1,1),p.vertices.push(h.x,h.y,0),p.pointSizes.push(5),p.vertexColors.push(0,0,1,1),p.vertices.push(h.x,h.y,u),p.pointSizes.push(d),p.vertexColors.push(.029*c,.015*c,.01*c,1)}s.borderColor=[.4,.8,1,1],s.borderWeight=3,e.add(a),e.add(s)}))}},regionFn:function(){var t=this;new AMap.DistrictSearch({subdistrict:0,extensions:"all",level:"city"}).search("北辰区",(function(e,a){for(var n=a.districtList[0].boundaries,o=[],i=0;i<n.length;i+=1)o.push([n[i]]);var r=new AMap.Object3DLayer({zIndex:1});t.map.add(r);var s="2D"===t.viewMode?0:-8e3,l=new AMap.Object3D.Wall({path:n,height:s,color:"#0088ffcc"});l.transparent=!0,r.add(l);for(var p=0;p<n.length;p+=1)new AMap.Polyline({path:n[p],strokeColor:"#99ffff",strokeWeight:4,map:t.map})}))},panToFn:function(){this.map.panBy(200*Math.random(),200*Math.random()),this.map.setZoom(18)},handleCommand:function(t){if("a"===t){if("2D"===this.viewMode)return;this.viewMode="2D",this.layerCtrl=!1,this.getMap()}else"b"===t?"3D"!==this.viewMode&&(this.layerCtrl=!1,this.viewMode="3D",this.getMap()):this.layerCtrl?(this.layerCtrl=!1,this.statelLayer.hide()):(this.layerCtrl=!0,this.statelLayer.setMap(this.map),this.statelLayer.show())},pullZoomFn:function(){if(this.pullZoom)log.error("拉框缩放已关闭"),this.pullZoomTxt="拉框缩放",this.pullZoom.close(!0),this.pullZoom=null;else{var t=new AMap.MouseTool(this.map);this.pullZoom=t,log.success("拉框缩放已开启"),this.pullZoomTxt="拉框缩放关闭",t.rectZoomIn({strokeColor:"#80d8ff",fillColor:"#80d8ff",fillOpacity:.3})}},pointAggre:function(){for(var t,e=this,a=[],n=[{lnglat:["117.171181","39.266659"]},{lnglat:["117.052299","39.202512"]},{lnglat:["117.171206","39.188873"]},{lnglat:["117.21767","39.071575"]},{lnglat:["117.209074","39.044769"]},{lnglat:["117.209074","39.044769"]},{lnglat:["117.151745","39.221364"]}],o=0;o<n.length;o+=1)a.push(new AMap.Marker({position:n[o].lnglat,content:'<div style="background-color: hsla(180, 100%, 50%, 0.7); height: 24px; width: 24px; border: 1px solid hsl(180, 100%, 40%); border-radius: 12px; box-shadow: hsl(180, 100%, 50%) 0px 0px 1px;"></div>',offset:new AMap.Pixel(-15,-15)}));var i=a.length,r=function(t){var e=Math.pow(t.count/i,1/18),a=document.createElement("div"),n=180-180*e,o="hsla("+n+",100%,50%,0.7)",r="hsla("+n+",100%,20%,1)",s="hsla("+n+",100%,40%,1)",l="hsla("+n+",100%,50%,1)";a.style.backgroundColor=o;var p=Math.round(30+20*Math.pow(t.count/i,.2));a.style.width=a.style.height=p+"px",a.style.border="solid 1px "+s,a.style.borderRadius=p/2+"px",a.style.boxShadow="0 0 1px "+l,a.innerHTML=t.count,a.style.lineHeight=p+"px",a.style.color=r,a.style.fontSize="14px",a.style.textAlign="center",t.marker.setOffset(new AMap.Pixel(-p/2,-p/2)),t.marker.setContent(a)};!function(n){t&&t.setMap(null);if(2==n)t=new AMap.MarkerClusterer(e.map,a,{gridSize:80,renderClusterMarker:r});else if(1==n){var o=[{url:"https://a.amap.com/jsapi_demos/static/images/blue.png",size:new AMap.Size(32,32),offset:new AMap.Pixel(-16,-16)},{url:"https://a.amap.com/jsapi_demos/static/images/green.png",size:new AMap.Size(32,32),offset:new AMap.Pixel(-16,-16)},{url:"https://a.amap.com/jsapi_demos/static/images/orange.png",size:new AMap.Size(36,36),offset:new AMap.Pixel(-18,-18)},{url:"https://a.amap.com/jsapi_demos/static/images/red.png",size:new AMap.Size(48,48),offset:new AMap.Pixel(-24,-24)},{url:"https://a.amap.com/jsapi_demos/static/images/darkRed.png",size:new AMap.Size(48,48),offset:new AMap.Pixel(-24,-24)}];t=new AMap.MarkerClusterer(e.map,a,{styles:o,gridSize:80})}else t=new AMap.MarkerClusterer(e.map,a,{gridSize:80})}(1)},waterRipple:function(){var t=document.createElement("canvas");t.width=t.height=200;var e=t.getContext("2d");e.fillStyle="rgb(0,100,255)",e.strokeStyle="white",e.globalAlpha=1,e.lineWidth=2;var a=0,n=new AMap.CanvasLayer({canvas:t,bounds:new AMap.Bounds([117.141653,39.21992],[117.145321,39.22226]),zooms:[3,18]});n.setMap(this.map),function t(){e.clearRect(0,0,200,200),e.globalAlpha=(e.globalAlpha-.01+1)%1,a=(a+1)%100,e.beginPath(),e.arc(100,100,a,0,2*Math.PI),e.fill(),e.stroke(),n.reFresh(),AMap.Util.requestAnimFrame(t)}()},flyLine:function(){var t=[new AMap.LngLat(117.209258,39.133229),new AMap.LngLat(117.974757,40.877),new AMap.LngLat(123.512344,41.831058),new AMap.LngLat(126.50891,45.834993)],e=new AMap.Object3DLayer,a=new AMap.Object3D.MeshLine({path:function(t,e){var a,o,i=[];for(a=1/(e-1),o=0;o<e;o++)i[o]=n(t,o*a);return i}(t,180),height:o(180,2e6,20),color:"rgba(55,129,240, 0.9)",width:10});function n(t,e){var a,n,o,i,r,s,l,p;o=3*(t[1].lng-t[0].lng),n=3*(t[2].lng-t[1].lng)-o,a=t[3].lng-t[0].lng-o-n,s=3*(t[1].lat-t[0].lat),r=3*(t[2].lat-t[1].lat)-s,i=t[3].lat-t[0].lat-s-r;var c=a*(p=(l=e*e)*e)+n*l+o*e+t[0].lng,h=i*p+r*l+s*e+t[0].lat;return new AMap.LngLat(c,h)}function o(t,e,a){for(var n=[],o=Math.PI/180,i=0;i<t;i++){var r=i*o;n.push(a+Math.sin(r)*e)}return n}a.transparent=!0,e.add(a),a.backOrFront="both",this.map.add(e),a.setWidth(5),a.setHeight(o(180,2e6,20))},infoWindowFn:function(){var t,e=this;t=new AMap.Marker({position:[116.481181,39.989792]}),e.map.add(t);var a=[];a.push("<img src='http://tpc.googlesyndication.com/simgad/5843493769827749134'>地址：北京市朝阳区阜通东大街6号院3号楼东北8.3公里"),a.push("电话：010-64733333"),a.push("<a href='https://ditu.amap.com/detail/B000A8URXB?citycode=110105'>详细信息</a>");new AMap.InfoWindow({isCustom:!0,content:function(t,e){var a=document.createElement("div");a.className="custom-info input-card content-window-card";var o=document.createElement("div"),i=document.createElement("div"),r=document.createElement("img");o.className="info-top",i.innerHTML=t,r.src="https://webapi.amap.com/images/close2.gif",r.onclick=n,o.appendChild(i),o.appendChild(r),a.appendChild(o);var s=document.createElement("div");s.className="info-middle",s.style.backgroundColor="white",s.innerHTML=e,a.appendChild(s);var l=document.createElement("div");l.className="info-bottom",l.style.position="relative",l.style.top="0px",l.style.margin="0 auto";var p=document.createElement("img");return p.src="https://webapi.amap.com/images/sharp.png",l.appendChild(p),a.appendChild(l),a}('方恒假日酒店<span style="font-size:11px;color:#F00;">价格:318</span>',a.join("<br/>")),offset:new AMap.Pixel(16,-45)});function n(){e.map.clearInfoWindow()}}}},o=(a(648),a(3)),i=Object(o.a)(n,(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"view-wrap"},[a("div",{staticClass:"w100h100",attrs:{id:"container_map"}}),t._v(" "),a("div",{staticClass:"left-top"},[a("el-dropdown",{on:{command:t.handleCommand}},[a("span",{staticClass:"el-dropdown-link",staticStyle:{color:"#fff"}},[t._v("\n        下拉菜单"),a("i",{staticClass:"el-icon-arrow-down el-icon--right"})]),t._v(" "),a("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[a("el-dropdown-item",{attrs:{command:"a"}},[t._v("2D")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"b"}},[t._v("3D")]),t._v(" "),a("el-dropdown-item",{attrs:{command:"c"}},[t._v("卫星图")])],1)],1),t._v(" "),a("el-button",{attrs:{type:"text",size:"small"},on:{click:t.panToFn}},[t._v("平移")]),t._v(" "),a("div",[a("el-button",{attrs:{type:"text",size:"mini"},on:{click:t.drawRegion}},[t._v("手动绘制")])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"text"},on:{click:t.addHeightMarker}},[t._v("添加高度点")])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"text"},on:{click:t.pullZoomFn}},[t._v(t._s(t.pullZoomTxt))])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"text"},on:{click:t.setMeshLayer}},[t._v("添加3d模型")])],1),t._v(" "),a("div",[a("el-button",{attrs:{type:"text"},on:{click:t.showHotMap}},[t._v(t._s(t.hotMapCtx))])],1)],1),t._v(" "),a("div",{staticClass:"right-bottom"},[a("span",[t._v("路线规划")]),t._v(" "),a("el-input",{staticClass:"rolut",attrs:{size:"mini",placeholder:"起始点"},model:{value:t.startPoint,callback:function(e){t.startPoint=e},expression:"startPoint"}}),t._v(" "),a("el-input",{staticClass:"rolut",attrs:{size:"mini",placeholder:"终点"},model:{value:t.endPoint,callback:function(e){t.endPoint=e},expression:"endPoint"}}),t._v(" "),a("el-button",{staticClass:"rolut",attrs:{type:"primary",size:"mini"},on:{click:t.rolutPlan}},[t._v("提交")]),t._v(" "),a("el-button",{staticClass:"rolut",attrs:{type:"primary",size:"mini"},on:{click:t.trajectoryFn}},[t._v("回放")])],1),t._v(" "),a("div",{attrs:{id:"panel"}})])}),[],!1,null,"52b2f6f3",null);e.default=i.exports}}]);